---
namespace: hazelcast

hazelcast:
  defines: runnable
  metadata:
    private: true
  services:
    hazelcast:
      container: hazelcast
      port: 5701
      protocol: tcp
  containers:
    hazelcast:
      image: hazelcast/hazelcast
      image-tag: <- `${hz-image-tag}`
  files:
    advanced-config:
      container: hazelcast
      mode: 0644
      path: /opt/hazelcast/config/hazelcast-config.yml
      contents: <<< files/hazelcast-config.yml
  variables:
    hz-clustername:
      env: HZ_CLUSTERNAME
      value: <- $cluster-name default("local-cluster")
      type: string
    java-opts:
      env: JAVA_OPTS
      value: -Dhazelcast.config=/opt/hazelcast/config/hazelcast-config.yml
      type: string
    hz-image-tag:
      value: <- $hazelcast-image-tag default("5.2.1")
      type: string         

hazelcast-management:
  defines: runnable
  services:
    hazelcast-management:
      container: hazelcast-management
      port: 8080
      protocol: tcp
      host-port: 8080
  connections:
    hazelcast:
      runnable: hazelcast/hazelcast
      service: hazelcast
  metadata:
    private: true
  containers:
    hazelcast-management:
      image: hazelcast/management-center
      image-tag: <- `${hzmgmt-image-tag}`
  variables:
    hzmgmt-image-tag:
      value: <- $hazelcast-management-image-tag default("latest")
      type: string
    hz-clustername:
      env: MC_DEFAULT_CLUSTER
      value: <- $cluster-name default("local-cluster")
      type: string
    hz-cluster-hostname:
      env: MC_DEFAULT_CLUSTER_MEMBERS
      value: <- connection-hostname("hazelcast")
      type: string
